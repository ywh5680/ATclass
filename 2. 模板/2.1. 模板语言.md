## 模板语言

Django模板语言（DTL）是一种强大的模板系统，用于生成动态HTML内容。它提供了变量、标签、过滤器和注释等语法元素，让开发者能够创建灵活且可重用的模板。

### 模板语法基础

Django模板使用以下语法元素：

- **变量**：`{{ variable }}` - 用于输出变量值
- **标签**：`{% tag %}` - 用于控制模板逻辑
- **过滤器**：`{{ variable|filter }}` - 用于修改变量值
- **注释**：`{# comment #}` - 用于添加注释

### 模板结构

本教程将模板语言分为以下几个部分：

1. **[变量](2.1.1.%20变量.md)** - 模板变量的使用方法和技巧
2. **[标签](2.1.2.%20标签.md)** - 模板标签的详细说明和用法
3. **[过滤器](2.1.3.%20过滤器.md)** - 内置过滤器的使用方法
4. **[自定义过滤器](2.1.4.%20自定义过滤器.md)** - 创建和使用自定义过滤器
5. **[注释](2.1.5.%20注释.md)** - 模板注释的语法和最佳实践

### 基本示例

下面是一个简单的模板示例，展示了各种语法元素的使用：

```html
{% extends "base.html" %}

{% block title %}Blog Posts{% endblock %}

{% block content %}
    <h1>Blog Posts</h1>
    
    {% if posts %}
        <div class="posts">
            {% for post in posts %}
                <article class="post">
                    <h2><a href="{% url 'post-detail' post.slug %}">{{ post.title }}</a></h2>
                    
                    <div class="meta">
                        <span class="author">By {{ post.author.get_full_name|default:post.author.username }}</span>
                        <span class="date">{{ post.published_date|date:"F j, Y" }}</span>
                    </div>
                    
                    <div class="excerpt">
                        {{ post.content|truncatewords:50|linebreaks }}
                    </div>
                </article>
            {% empty %}
                <p>No posts available.</p>
            {% endfor %}
        </div>
    {% else %}
        <p>No blog posts found.</p>
    {% endif %}
{% endblock %}
```

### 模板继承

Django模板支持继承，允许创建可重用的页面布局：

```html
<!-- base.html -->
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}My Site{% endblock %}</title>
</head>
<body>
    <div id="content">
        {% block content %}{% endblock %}
    </div>
</body>
</html>

<!-- child.html -->
{% extends "base.html" %}

{% block title %}Child Page{% endblock %}

{% block content %}
    <h1>Child Page Content</h1>
    <p>This is the child page content.</p>
{% endblock %}
```

### 在视图中使用模板

在视图中使用`render()`函数渲染模板：

```python
from django.shortcuts import render
from .models import Post

def index(request):
    latest_posts = Post.objects.filter(status='published')[:5]
    context = {'posts': latest_posts}
    return render(request, 'blog/index.html', context)
```

### 静态文件

在模板中包含静态文件（CSS、JavaScript、图片等）：

```html
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'blog/style.css' %}">
<script src="{% static 'blog/script.js' %}"></script>
<img src="{% static 'blog/images/logo.png' %}" alt="Logo">
```

### 安全特性

Django模板系统包含重要的安全特性：

- **自动转义**：默认情况下，所有变量输出都会被转义，防止XSS攻击
- **CSRF保护**：使用`{% csrf_token %}`标签保护表单提交
- **安全过滤器**：谨慎使用`safe`过滤器，确保内容安全

### 性能考虑

1. **避免在模板中进行复杂计算**
2. **使用适当的缓存策略**
3. **合理使用模板继承和包含**
4. **避免深层嵌套循环**

### 最佳实践

1. **保持模板简洁**：复杂的业务逻辑应该在视图中处理
2. **使用描述性名称**：为变量、块和模板文件使用清晰的名称
3. **合理组织模板**：使用继承和包含来避免代码重复
4. **测试模板**：确保模板在各种情况下都能正确渲染

## 小结

- Django模板语言提供了强大的HTML生成功能
- 支持变量、标签、过滤器和注释等语法元素
- 模板继承允许创建可重用的页面布局
- 包含重要的安全特性，如自动转义和CSRF保护
- 应该遵循最佳实践，保持模板的简洁性和可维护性

详细的使用说明请参考各个子章节的文档。
