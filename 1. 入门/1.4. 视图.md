## 视图基础

在Django中，视图是一个Python函数，它接收Web请求并返回Web响应。视图负责处理业务逻辑并返回适当的响应（如HTML页面、重定向、404错误等）。

### 简单视图示例

下面是一个简单的视图函数示例：

```python
# polls/views.py
from django.http import HttpResponse

def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")
```

这个视图返回一个包含文本的`HttpResponse`对象。

### 映射URL到视图

在`urls.py`文件中，我们将URL模式映射到视图函数：

```python
# polls/urls.py
from django.urls import path
from . import views

urlpatterns = [
    # ex: /polls/
    path('', views.index, name='index'),
    # ex: /polls/5/
    path('<int:question_id>/', views.detail, name='detail'),
    # ex: /polls/5/results/
    path('<int:question_id>/results/', views.results, name='results'),
    # ex: /polls/5/vote/
    path('<int:question_id>/vote/', views.vote, name='vote'),
]
```

### 使用模型数据

视图通常需要从数据库获取数据。以下是一个从数据库获取数据的视图示例：

```python
# polls/views.py
from django.http import HttpResponse
from .models import Question

def index(request):
    latest_question_list = Question.objects.order_by('-pub_date')[:5]
    output = ', '.join([q.question_text for q in latest_question_list])
    return HttpResponse(output)
```

### 请求对象(HttpRequest)

视图函数的第一个参数总是`request`，它是一个`HttpRequest`对象，包含了请求的元数据：

- `request.method`: 请求方法（'GET', 'POST'等）
- `request.GET`: 包含所有GET参数的字典
- `request.POST`: 包含所有POST参数的字典
- `request.FILES`: 包含所有上传文件的字典
- `request.COOKIES`: 包含所有cookies的字典
- `request.session`: 包含会话数据的字典

### 响应对象(HttpResponse)

视图函数必须返回一个`HttpResponse`对象或其子类：

```python
from django.http import HttpResponse

# 简单文本响应
response = HttpResponse("Text only, please.", content_type="text/plain")

# HTML响应
response = HttpResponse("<h1>Hello World</h1>")

# 设置响应头
response = HttpResponse()
response['Age'] = 120
```


## 小结

- 视图是接收Web请求并返回Web响应的Python函数
- 视图可以从URL接收参数
- 视图通常从数据库获取数据，处理后通过模板渲染成HTML
- Django提供了丰富的请求和响应对象，简化了Web开发