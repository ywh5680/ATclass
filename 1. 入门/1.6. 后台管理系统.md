## 后台管理系统

Django内置了一个功能强大的自动化管理界面，让你可以轻松管理网站的内容。

### 创建管理员账户

首先，创建一个可以登录管理站点的用户：

```bash
python manage.py createsuperuser
```

按照提示输入用户名、邮箱地址和密码。

### 启动开发服务器

启动开发服务器：

```bash
python manage.py runserver
```

现在，打开浏览器访问 http://127.0.0.1:8000/admin/ ，你会看到管理员登录界面。输入你刚才创建的超级用户凭据登录。

### 向管理站点注册模型

默认情况下，Django的管理站点只显示你已经注册的模型。要注册模型，编辑应用的`admin.py`文件：

```python
# polls/admin.py
from django.contrib import admin
from .models import Question

admin.site.register(Question)
```

这样，Question模型就会出现在管理界面中。

### 探索管理功能

登录后，你可以：

1. 添加、修改和删除模型实例
2. 查看修改历史
3. 按字段过滤和搜索记录

### 自定义管理表单

你可以通过创建一个模型管理类来自定义管理表单：

```python
# polls/admin.py
from django.contrib import admin
from .models import Question

class QuestionAdmin(admin.ModelAdmin):
    fields = ['pub_date', 'question_text']

admin.site.register(Question, QuestionAdmin)
```

这样可以更改表单中字段的顺序。

### 字段集

对于有很多字段的表单，可以将它们分组为字段集：

```python
class QuestionAdmin(admin.ModelAdmin):
    fieldsets = [
        (None,               {'fields': ['question_text']}),
        ('Date information', {'fields': ['pub_date']}),
    ]

admin.site.register(Question, QuestionAdmin)
```

### 关联模型

如果你有关联的模型（如Question和Choice），可以在同一页面编辑它们：

```python
from django.contrib import admin
from .models import Question, Choice

class ChoiceInline(admin.TabularInline):
    model = Choice
    extra = 3

class QuestionAdmin(admin.ModelAdmin):
    fieldsets = [
        (None,               {'fields': ['question_text']}),
        ('Date information', {'fields': ['pub_date']}),
    ]
    inlines = [ChoiceInline]

admin.site.register(Question, QuestionAdmin)
```

### 自定义列表页

你可以自定义模型的列表页：

```python
class QuestionAdmin(admin.ModelAdmin):
    list_display = ('question_text', 'pub_date')
    list_filter = ['pub_date']
    search_fields = ['question_text']
```

这会显示更多列、添加过滤器侧边栏和搜索框。

### 自定义管理站点外观

你可以通过创建模板来自定义管理站点的外观。创建一个`templates/admin/base_site.html`文件：

```html
{% extends "admin/base.html" %}

{% block title %}{{ title }} | My Site Admin{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'admin:index' %}">My Site Administration</a></h1>
{% endblock %}
```

确保你的`TEMPLATES`设置包含适当的目录：

```python
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],
        'APP_DIRS': True,
        # ...
    },
]
```

## 小结

- Django的管理站点提供了一个现成的界面来管理你的数据
- 只需几行代码就可以注册模型并开始使用
- 可以通过创建模型管理类来自定义表单和列表页
- 可以在同一页面编辑关联的模型
- 可以通过模板自定义管理站点的外观
