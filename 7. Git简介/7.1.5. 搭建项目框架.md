## 搭建项目框架

项目框架是项目的基础结构，包括目录组织、配置文件、依赖管理等。本章将详细介绍如何使用 Git 搭建和管理项目框架。

### 项目框架基础

#### 1. 什么是项目框架

项目框架是项目的骨架结构，包括：

- **目录结构**：文件和文件夹的组织方式
- **配置文件**：项目的各种配置文件
- **依赖管理**：项目依赖的声明和管理
- **构建脚本**：自动化构建和部署脚本
- **文档结构**：项目文档的组织

#### 2. 框架的重要性

- **标准化**：统一的项目结构
- **可维护性**：清晰的组织便于维护
- **可扩展性**：易于添加新功能
- **团队协作**：统一的规范便于协作

### 初始化项目

#### 1. 创建项目目录

```bash
# 创建项目目录
mkdir my-project
cd my-project

# 初始化 Git 仓库
git init

# 查看仓库状态
git status
```

#### 2. 配置用户信息

```bash
# 设置全局用户信息
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"

# 设置本地用户信息
git config user.name "Your Name"
git config user.email "your.email@example.com"

# 查看配置
git config --list
```

#### 3. 创建 .gitignore 文件

```bash
# 创建 .gitignore 文件
touch .gitignore

# 编辑 .gitignore 文件
cat > .gitignore << 'EOF'
# 操作系统文件
.DS_Store
Thumbs.db
desktop.ini

# 编辑器文件
.vscode/
.idea/
*.swp
*.swo
*~

# 编译文件
*.pyc
__pycache__/
*.o
*.exe
*.dll
*.so

# 依赖目录
node_modules/
venv/
env/
.env

# 日志文件
*.log
logs/

# 临时文件
*.tmp
*.temp
temp/
tmp/

# 数据库文件
*.db
*.sqlite
*.sqlite3

# 配置文件
config.ini
.env.local
.env.production

# 构建输出
dist/
build/
*.egg-info/

# 测试覆盖率
.coverage
htmlcov/
.pytest_cache/
EOF
```

### 项目结构搭建

#### 1. 创建基本目录结构

```bash
# 创建项目目录结构
mkdir -p src/{components,utils,services}
mkdir -p docs/{api,user-guide}
mkdir -p tests/{unit,integration}
mkdir -p scripts
mkdir -p config
mkdir -p assets/{images,styles,scripts}

# 查看目录结构
tree -a
# 或者使用 ls
ls -la
```

#### 2. 创建基本文件

```bash
# 创建 README 文件
cat > README.md << 'EOF'
# My Project

## 项目简介

这是一个示例项目，用于演示项目框架的搭建。

## 功能特性

- 功能1
- 功能2
- 功能3

## 安装使用

```bash
# 克隆项目
git clone https://github.com/username/my-project.git

# 安装依赖
npm install

# 运行项目
npm start
```

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 许可证

MIT License
EOF

# 创建 LICENSE 文件
cat > LICENSE << 'EOF'
MIT License

Copyright (c) 2024 Your Name

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
EOF
```

### 配置文件管理

#### 1. 创建配置文件

```bash
# 创建 package.json（Node.js 项目）
cat > package.json << 'EOF'
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "A sample project",
  "main": "src/index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "jest",
    "build": "webpack --mode production",
    "lint": "eslint src/",
    "format": "prettier --write src/"
  },
  "keywords": ["sample", "project"],
  "author": "Your Name",
  "license": "MIT",
  "dependencies": {
    "express": "^4.18.2"
  },
  "devDependencies": {
    "nodemon": "^3.0.1",
    "jest": "^29.7.0",
    "eslint": "^8.54.0",
    "prettier": "^3.1.0"
  }
}
EOF

# 创建 requirements.txt（Python 项目）
cat > requirements.txt << 'EOF'
# Web 框架
Flask==2.3.3
Django==4.2.7

# 数据库
SQLAlchemy==2.0.23
psycopg2-binary==2.9.9

# 测试
pytest==7.4.3
pytest-cov==4.1.0

# 代码质量
flake8==6.1.0
black==23.11.0

# 环境管理
python-dotenv==1.0.0
EOF

# 创建 .env.example 文件
cat > .env.example << 'EOF'
# 数据库配置
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mydatabase
DB_USER=myuser
DB_PASSWORD=mypassword

# 应用配置
APP_SECRET_KEY=your-secret-key-here
DEBUG=True
ENVIRONMENT=development

# 外部服务
API_KEY=your-api-key-here
WEBHOOK_URL=https://example.com/webhook
EOF
```

#### 2. 创建构建脚本

```bash
# 创建构建脚本
cat > scripts/build.sh << 'EOF'
#!/bin/bash

# 构建脚本
echo "开始构建项目..."

# 安装依赖
npm install

# 运行测试
npm test

# 构建项目
npm run build

# 检查构建结果
if [ $? -eq 0 ]; then
    echo "构建成功！"
else
    echo "构建失败！"
    exit 1
fi
EOF

# 设置脚本权限
chmod +x scripts/build.sh

# 创建部署脚本
cat > scripts/deploy.sh << 'EOF'
#!/bin/bash

# 部署脚本
echo "开始部署项目..."

# 构建项目
./scripts/build.sh

# 部署到服务器
# 这里可以添加具体的部署命令

echo "部署完成！"
EOF

chmod +x scripts/deploy.sh
```

### 版本控制配置

#### 1. 初始化提交

```bash
# 添加所有文件到暂存区
git add .

# 创建初始提交
git commit -m "Initial commit: Setup project framework"

# 查看提交历史
git log --oneline
```

#### 2. 创建远程仓库

```bash
# 添加远程仓库
git remote add origin https://github.com/username/my-project.git

# 验证远程仓库
git remote -v

# 推送到远程仓库
git push -u origin main
```

#### 3. 设置分支保护

```bash
# 创建开发分支
git checkout -b develop

# 推送开发分支
git push -u origin develop

# 切换回主分支
git checkout main
```

### 文档结构

#### 1. 创建文档

```bash
# 创建 API 文档
cat > docs/api/README.md << 'EOF'
# API 文档

## 概述

本文档描述了项目的 API 接口。

## 认证

所有 API 请求都需要在头部包含认证令牌：

```
Authorization: Bearer <token>
```

## 接口列表

### 用户管理

#### 获取用户列表

- **URL**: `/api/users`
- **方法**: `GET`
- **参数**: 
  - `page`: 页码（可选）
  - `limit`: 每页数量（可选）

#### 创建用户

- **URL**: `/api/users`
- **方法**: `POST`
- **参数**:
  - `username`: 用户名
  - `email`: 邮箱
  - `password`: 密码
EOF

# 创建用户指南
cat > docs/user-guide/README.md << 'EOF'
# 用户指南

## 快速开始

### 安装

1. 克隆项目
2. 安装依赖
3. 配置环境
4. 运行项目

### 使用说明

详细的使用说明请参考各个章节。
EOF
```

#### 2. 创建变更日志

```bash
# 创建 CHANGELOG.md
cat > CHANGELOG.md << 'EOF'
# 变更日志

本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [未发布]

### 新增
- 初始项目框架

### 变更
- 无

### 修复
- 无

## [1.0.0] - 2024-01-01

### 新增
- 项目初始化
- 基本功能实现
EOF
```

### 测试框架

#### 1. 创建测试文件

```bash
# 创建测试配置文件
cat > tests/conftest.py << 'EOF'
import pytest
import sys
import os

# 添加项目根目录到 Python 路径
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

@pytest.fixture
def sample_data():
    """提供测试数据"""
    return {
        'user': {
            'id': 1,
            'username': 'testuser',
            'email': 'test@example.com'
        }
    }
EOF

# 创建单元测试
cat > tests/unit/test_utils.py << 'EOF'
import pytest
from src.utils.helpers import format_name

def test_format_name():
    """测试格式化名称函数"""
    assert format_name("john doe") == "John Doe"
    assert format_name("JANE SMITH") == "Jane Smith"
    assert format_name("") == ""

def test_format_name_with_numbers():
    """测试包含数字的名称"""
    assert format_name("john123") == "John123"
EOF

# 创建集成测试
cat > tests/integration/test_api.py << 'EOF'
import pytest
import requests

def test_api_health_check():
    """测试 API 健康检查"""
    response = requests.get('http://localhost:3000/health')
    assert response.status_code == 200
    assert response.json()['status'] == 'ok'
EOF
```

### 持续集成配置

#### 1. GitHub Actions

```bash
# 创建 GitHub Actions 配置
mkdir -p .github/workflows

cat > .github/workflows/ci.yml << 'EOF'
name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [16.x, 18.x, 20.x]

    steps:
    - uses: actions/checkout@v4
    
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v4
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run tests
      run: npm test
    
    - name: Run linting
      run: npm run lint
    
    - name: Build project
      run: npm run build
EOF
```

#### 2. GitLab CI

```bash
# 创建 GitLab CI 配置
cat > .gitlab-ci.yml << 'EOF'
stages:
  - test
  - build
  - deploy

test:
  stage: test
  image: node:18
  script:
    - npm ci
    - npm test
    - npm run lint
  only:
    - main
    - develop

build:
  stage: build
  image: node:18
  script:
    - npm ci
    - npm run build
  artifacts:
    paths:
      - dist/
  only:
    - main

deploy:
  stage: deploy
  script:
    - echo "部署到生产环境"
  only:
    - main
EOF
```

### 项目模板

#### 1. 创建模板脚本

```bash
# 创建项目模板脚本
cat > scripts/create-project.sh << 'EOF'
#!/bin/bash

# 项目创建脚本
PROJECT_NAME=$1

if [ -z "$PROJECT_NAME" ]; then
    echo "请提供项目名称"
    echo "用法: ./scripts/create-project.sh <project-name>"
    exit 1
fi

echo "创建项目: $PROJECT_NAME"

# 创建项目目录
mkdir $PROJECT_NAME
cd $PROJECT_NAME

# 初始化 Git 仓库
git init

# 创建基本目录结构
mkdir -p src/{components,utils,services}
mkdir -p docs/{api,user-guide}
mkdir -p tests/{unit,integration}
mkdir -p scripts
mkdir -p config
mkdir -p assets/{images,styles,scripts}

# 复制模板文件
# 这里可以添加复制模板文件的命令

echo "项目 $PROJECT_NAME 创建完成！"
EOF

chmod +x scripts/create-project.sh
```

### 最佳实践

#### 1. 目录结构规范

```bash
# 推荐的项目结构
project/
├── .git/                 # Git 版本控制
├── .github/              # GitHub 配置
├── src/                  # 源代码
│   ├── components/       # 组件
│   ├── utils/           # 工具函数
│   └── services/        # 服务
├── docs/                # 文档
│   ├── api/             # API 文档
│   └── user-guide/      # 用户指南
├── tests/               # 测试文件
│   ├── unit/            # 单元测试
│   └── integration/     # 集成测试
├── scripts/             # 脚本文件
├── config/              # 配置文件
├── assets/              # 静态资源
├── README.md            # 项目说明
├── LICENSE              # 许可证
├── .gitignore           # Git 忽略文件
├── package.json         # 项目配置
├── requirements.txt     # Python 依赖
└── CHANGELOG.md         # 变更日志
```

#### 2. 提交规范

```bash
# 提交信息格式
# <type>(<scope>): <subject>
#
# <body>
#
# <footer>

# 类型说明
# feat: 新功能
# fix: 修复
# docs: 文档
# style: 格式
# refactor: 重构
# test: 测试
# chore: 构建

# 示例
git commit -m "feat(user): add user authentication

- Add login/logout functionality
- Add user registration
- Add password reset

Closes #123"
```

### 总结

通过本章的学习，你应该掌握了：

1. **项目框架基础**：理解项目框架的概念和重要性
2. **项目初始化**：创建和配置新项目
3. **目录结构**：建立标准的项目目录结构
4. **配置文件**：创建各种配置文件
5. **版本控制**：配置 Git 和远程仓库
6. **文档结构**：创建项目文档
7. **测试框架**：设置测试环境
8. **持续集成**：配置 CI/CD 流程

项目框架是项目成功的基础，良好的框架设计将大大提高开发效率和项目质量。
